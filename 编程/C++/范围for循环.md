## 一、范围 for 循环是什么？

范围 for 循环是 C++11 新增的语法糖，专门用来 **遍历 “有明确范围的集合”**（比如 `string`、`vector` 等），本质是简化了传统的迭代器循环或下标循环。

对 `string` 来说，它的核心作用就是：**不用管索引、不用算长度，直接遍历每个字符**—— 比 C 语言的 `for (int i=0; i<strlen(s); i++)` 更简洁，比 `string` 的迭代器循环更直观。

|范围 for 里的部分|通俗意思|对应 C 语言的逻辑|核心作用|
|---|---|---|---|
|`for (...)`|循环关键字（和 C 语言的 `for` 一样）|同 C 语言 `for`（循环控制）|告诉编译器 “这是一个循环”|
|`char ch`|循环变量：每次取一个 “元素” 存这里|`char ch;`（定义一个字符变量）|接收遍历到的字符（比如第一次是 'h'，第二次是 'e'）|
|`:`|分隔符：“从后面的集合里取元素”|无直接对应（C 语言没有这语法）|连接 “循环变量” 和 “要遍历的集合”|
|`s`|要遍历的 “集合”（这里是 `string`）|`char s[] = "hello";`（字符数组）|告诉编译器 “要遍历哪个东西”（`string` 本质是字符集合）|
|`{ ... }`|循环体（和 C 语言一样）|同 C 语言循环体|每次遍历要执行的代码|




## 二、string 中范围 for 的 3 种核心用法

假设我们有个字符串 `string s = "hello";`，按 “只读”“可修改”“防拷贝” 分类，覆盖 99% 场景：

### 1. 只读遍历（最常用）

想遍历字符但不修改，直接用 `char ch`：

cpp

```cpp
// C++ 范围 for（只读）
for (char ch : s) {
    cout << ch << " "; // 输出：h e l l o
}
```

#### 对比 C 语言的遍历方式：

c

```c
// C 语言（需要手动算长度、管索引）
char s[] = "hello";
for (int i=0; i<strlen(s); i++) {
    printf("%c ", s[i]);
}
```

核心优势：C++ 不用写 `i`、不用算 `strlen`（`string` 的 `size()` 是 O (1)，但范围 for 连 `size()` 都不用写），代码更短、不容易出错（比如索引越界）。

### 2. 可修改遍历（改字符）

想遍历的时候修改字符（比如转大写），必须用 `char& ch`（`&` 表示引用，直接操作原字符串的字符，不是拷贝）：

cpp

```cpp
string s = "hello";
// 范围 for（可修改，注意 &）
for (char& ch : s) {
    ch = toupper(ch); // 每个字符转大写（toupper 是 C 标准库函数，需包含 <cctype>）
}
cout << s; // 输出：HELLO
```

#### 对比 C 语言的修改方式：

c

```c
char s[] = "hello";
for (int i=0; i<strlen(s); i++) {
    s[i] = toupper(s[i]);
}
printf("%s", s);
```

核心优势：C++ 不用通过 `s[i]` 访问，直接用 `ch` 修改，更直观；且 `string` 自动管内存，不用担心越界（比如改的时候超出原长度）。

### 3. 只读 + 防拷贝（性能优化）

如果字符串很长（比如 10 万字符），用 `const char& ch` 遍历 —— 既保证只读，又避免每次循环拷贝字符（虽然 `char` 拷贝开销极小，但这是好习惯，且适配复杂对象时有用）：

cpp

```cpp
string s = "很长很长的字符串...";
// 范围 for（只读+无拷贝，最优性能）
for (const char& ch : s) {
    cout << ch;
}
```

对 `char` 来说，`const char&` 和 `char` 性能几乎没区别，但建议养成这个习惯（比如后续遍历 `vector<string>` 时，`const string&` 能避免大量拷贝）。